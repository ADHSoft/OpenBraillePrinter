/*******************************************************************************************************************************//**
 *
 * @file		DR_SysTick.c
 * @brief		Descripcion del modulo
 * @date		4 de may. de 2016
 * @author		Ing. Marcelo Trujillo
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include "DR_motores.h"
#include "DR_SysTick.h"
#include "DR_lcd.h"
#include "DR_gpio.h"
#include "PR_Timers.h"
#include "PR_debounce.h"

/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/

/******************************************************************************************************************
 * @fn      void SysTick_Inicializacion ( void )
 * @brief   Inicializacion del systick para 2.5ms
 * @param:  void
 * @return: void
 *****************************************************************************************************************/
void SysTick_Inicializacion ( void )
{
	STRELOAD = ( STCALIB / 4) - 1; 	// 2.5 ms
	STCURR   = 0;

	CLKSOURCE = 1;
	ENABLE    = 1;
	TICKINT   = 1;
}

/******************************************************************************************************************
 * @fn      void SysTick_Handler(void)
 * @brief   Actualiza el LCD, motores, etc. cada vez que interrumpe el Systick
 * @param:  void
 * @return: void
 *****************************************************************************************************************/
void SysTick_Handler(void)
{

	TimerCheck();
	Debounce();
	DriverDemoraLCD();
	actualizar_motores();
}


